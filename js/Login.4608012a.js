import{f as e,m as a,i as t,g as s,E as o}from"./element-plus.f33a3a8b.js";import{b0 as r,f as n,o as l,h as m,X as d,V as u,b1 as i,a2 as p,v as c,j as f,Z as w,a9 as g}from"./vendor.4edac398.js";import{g as k,u as h}from"./api.14b5103b.js";import{_ as b}from"./index.c99f61cd.js";const O=r("user",{state:()=>({userStatus:{username:"",token:""}}),getters:{},actions:{setToken(e){this.userStatus.username=e.username,this.userStatus.token=e.token,localStorage.setItem("userInfo",JSON.stringify({username:e.username,token:e.token}))}}}),y=n({name:"Login",components:{},setup(){const e=O(),t=i(),s=p({title:"Admin Login",form:{username:"",password:"",otp:""},currentOtp:"",token:""}),o=async()=>{const e=await k("");200===e.data.Code?s.currentOtp=e.data.Data.OTP:a({message:`OTP API ERROR!! (${e.data.Code})`,type:"error"})},r=c((async()=>{await o()}));return{state:s,getOtpNumbers:o,handleLogin:async()=>{const a={username:s.form.username,password:s.form.password,otp:s.form.otp},o=await h(a);200===o.data.Code&&(s.token=o.data.Data.Token,await e.setToken({username:o.data.Data.Info.Account,token:o.data.Data.Token}),await t.push({name:"home"}))},init:r}}}),V={id:"login_form",class:"row vertical grow center"},_={class:"row horizontal v_center"},v={class:"row horizontal h_end"},T=g("Login");var C=b(y,[["render",function(a,r,n,i,p,c){const g=t,k=s,h=o,b=e;return l(),m("div",V,[d(b,{"label-width":"80px"},{default:u((()=>[d(k,{label:"帳號:"},{default:u((()=>[d(g,{modelValue:a.state.form.username,"onUpdate:modelValue":r[0]||(r[0]=e=>a.state.form.username=e),type:"text",placeholder:"Username"},null,8,["modelValue"])])),_:1}),d(k,{label:"密碼:"},{default:u((()=>[d(g,{modelValue:a.state.form.password,"onUpdate:modelValue":r[1]||(r[1]=e=>a.state.form.password=e),type:"password",placeholder:"Password"},null,8,["modelValue"])])),_:1}),d(k,{label:"OTP:"},{default:u((()=>[f("div",_,[d(g,{modelValue:a.state.form.otp,"onUpdate:modelValue":r[2]||(r[2]=e=>a.state.form.otp=e),type:"text",placeholder:"OTP"},null,8,["modelValue"]),f("div",{class:"otp_number",onClick:r[3]||(r[3]=(...e)=>a.getOtpNumbers&&a.getOtpNumbers(...e))},w(a.state.currentOtp),1)])])),_:1}),f("div",v,[d(h,{type:"primary",onClick:a.handleLogin},{default:u((()=>[T])),_:1},8,["onClick"])])])),_:1})])}]]);export{C as default};
